<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>MP SHOP POS PRO</title>

<style>
body{
font-family:sans-serif;
background:#f4f6f9;
margin:0;
padding:20px;
}
.container{
max-width:1200px;
margin:auto;
}
.layout{
display:flex;
gap:20px;
}
.left,.right{
flex:1;
background:white;
padding:20px;
border-radius:10px;
box-shadow:0 0 10px rgba(0,0,0,0.1);
}
input,select,button{
width:100%;
padding:10px;
margin:5px 0;
border-radius:5px;
border:1px solid #ccc;
}
button{
background:#1976d2;
color:white;
border:none;
cursor:pointer;
}
button:hover{
background:#125aa0;
}
table{
width:100%;
border-collapse:collapse;
}
th,td{
border:1px solid #ddd;
padding:10px;
text-align:center;
}
.product{
border:1px solid #ddd;
padding:10px;
margin:5px 0;
border-radius:5px;
}
.total{
font-size:20px;
font-weight:bold;
color:green;
}
.role-box{
margin-bottom:15px;
}
.admin-section{
background:#f1f3f5;
padding:15px;
border-radius:8px;
margin-top:15px;
}
</style>
</head>

<body>

<div class="container">

<h1>üõí MP SHOP POS PRO</h1>

<div class="role-box">
‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô:
<select id="roleSelect" onchange="changeRole()">
<option value="cashier">Cashier</option>
<option value="admin">Admin</option>
</select>
</div>

<div class="layout">

<!-- LEFT -->
<div class="left">

<h2>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</h2>

<div id="addProductSection">

<input id="pname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
<input id="price" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">
<input id="cost" type="number" placeholder="‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£)">
<input id="pstock" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏ï‡πä‡∏≠‡∏Å">

<button onclick="addProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>

</div>

<h2>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h2>
<input id="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." onkeyup="renderProducts()">

<h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
<div id="productList"></div>

</div>

<!-- RIGHT -->
<div class="right">

<h2>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h2>

<table>
<thead>
<tr>
<th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
<th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
<th>‡∏•‡∏ö</th>
</tr>
</thead>
<tbody id="cart"></tbody>
</table>

<br>
<div class="total">
‡∏£‡∏ß‡∏°: <span id="total">0</span> ‡∏ö‡∏≤‡∏ó
</div>

<br>
<button onclick="checkout()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>

<!-- ADMIN ONLY SECTION -->
<div id="adminOnly" class="admin-section">

<h3>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>

‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢: <span id="sales">0</span> ‡∏ö‡∏≤‡∏ó<br>
‡∏Å‡∏≥‡πÑ‡∏£: <span id="profit">0</span> ‡∏ö‡∏≤‡∏ó<br>
‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•: <span id="billCount">0</span><br><br>

<button onclick="exportCSV()">Export Excel (CSV)</button>

</div>

</div>

</div>
</div>

<script>

let products = JSON.parse(localStorage.getItem("products")) || [];
let cart = [];
let sales = parseFloat(localStorage.getItem("sales")) || 0;
let profit = parseFloat(localStorage.getItem("profit")) || 0;
let billCount = parseInt(localStorage.getItem("billCount")) || 0;

let role = localStorage.getItem("role") || "cashier";
document.getElementById("roleSelect").value = role;

function saveData(){
localStorage.setItem("products", JSON.stringify(products));
localStorage.setItem("sales", sales);
localStorage.setItem("profit", profit);
localStorage.setItem("billCount", billCount);
}

function changeRole(){
role = document.getElementById("roleSelect").value;
localStorage.setItem("role", role);
updateUI();
}

function updateUI(){

if(role === "admin"){
document.getElementById("adminOnly").style.display="block";
document.getElementById("addProductSection").style.display="block";
}else{
document.getElementById("adminOnly").style.display="none";
document.getElementById("addProductSection").style.display="none";
}

}

function addProduct(){

if(role !== "admin"){
alert("‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
return;
}

let name=document.getElementById("pname").value;
let price=parseFloat(document.getElementById("price").value);
let cost=parseFloat(document.getElementById("cost").value);
let stock=parseInt(document.getElementById("pstock").value);

if(!name || !price || !cost || !stock){
alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
return;
}

products.push({name,price,cost,stock});
saveData();
renderProducts();

document.getElementById("pname").value="";
document.getElementById("price").value="";
document.getElementById("cost").value="";
document.getElementById("pstock").value="";

}

function renderProducts(){

let search=document.getElementById("search").value.toLowerCase();
let list=document.getElementById("productList");
list.innerHTML="";

products.filter(p=>p.name.toLowerCase().includes(search))
.forEach((p,index)=>{

let div=document.createElement("div");
div.className="product";

div.innerHTML=`
<b>${p.name}</b><br>
‡∏£‡∏≤‡∏Ñ‡∏≤: ${p.price} ‡∏ö‡∏≤‡∏ó<br>
‡∏™‡∏ï‡πä‡∏≠‡∏Å: ${p.stock}<br>
<button onclick="addToCart(${index})">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
`;

list.appendChild(div);

});

}

function addToCart(index){

if(products[index].stock<=0){
alert("‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î");
return;
}

products[index].stock--;
cart.push(products[index]);
saveData();
renderProducts();
renderCart();

}

function renderCart(){

let tbody=document.getElementById("cart");
tbody.innerHTML="";
let total=0;

cart.forEach((item,i)=>{
total+=item.price;
tbody.innerHTML+=`
<tr>
<td>${item.name}</td>
<td>${item.price}</td>
<td><button onclick="removeCart(${i})">‡∏•‡∏ö</button></td>
</tr>
`;
});

document.getElementById("total").innerText=total;

}

function removeCart(i){
cart.splice(i,1);
renderCart();
}

function checkout(){

if(cart.length===0){
alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤");
return;
}

let total=cart.reduce((sum,item)=>sum+item.price,0);
let totalCost=cart.reduce((sum,item)=>sum+item.cost,0);

sales+=total;
profit+=(total-totalCost);
billCount++;

cart=[];
saveData();
renderCart();
updateReport();

alert("‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

}

function updateReport(){
document.getElementById("sales").innerText=sales;
document.getElementById("profit").innerText=profit;
document.getElementById("billCount").innerText=billCount;
}

function exportCSV(){

let csv="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢,‡∏Å‡∏≥‡πÑ‡∏£,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•\n";
csv+=`${sales},${profit},${billCount}`;

let blob=new Blob([csv],{type:"text/csv"});
let url=URL.createObjectURL(blob);
let a=document.createElement("a");
a.href=url;
a.download="report.csv";
a.click();

}

renderProducts();
renderCart();
updateReport();
updateUI();

</script>

</body>
</html>
