<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>MP SHOP POS PRO MAX</title>

<style>

body{
font-family:Arial;
background:#f0f2f5;
margin:0;
}

/* HEADER */
.header{
background:#2c3e50;
color:white;
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
box-shadow:0 3px 10px rgba(0,0,0,0.2);
}

/* CONTAINER */
.container{
padding:20px;
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

/* CARD */
.card{
background:white;
padding:15px;
border-radius:10px;
box-shadow:0 4px 12px rgba(0,0,0,0.15);
}

/* BUTTON */
button{
background:#3498db;
color:white;
border:none;
padding:10px;
cursor:pointer;
border-radius:6px;
font-weight:bold;
margin-top:5px;
width:100%;
}

button:hover{
background:#2980b9;
}

/* DELETE BUTTON */
.deleteBtn{
background:#e74c3c;
width:auto;
padding:5px 10px;
margin-left:10px;
}

.deleteBtn:hover{
background:#c0392b;
}

/* CLEAR BUTTON */
.clearBtn{
background:#e67e22;
}

.clearBtn:hover{
background:#d35400;
}

/* INPUT */
input{
width:100%;
padding:8px;
margin-top:5px;
border-radius:5px;
border:1px solid #ccc;
}

/* LOGIN */
.login-box{
width:300px;
margin:120px auto;
background:white;
padding:20px;
border-radius:10px;
box-shadow:0 0 10px rgba(0,0,0,0.3);
}

/* PRODUCT */
.product{
padding:10px;
background:#ecf0f1;
margin:5px;
cursor:pointer;
border-radius:5px;
}

.product:hover{
background:#d0d7de;
}

/* CART ITEM */
.cartItem{
display:flex;
justify-content:space-between;
align-items:center;
background:#f9f9f9;
padding:8px;
margin:5px;
border-radius:5px;
}

/* QR */
.qrBox{
text-align:center;
}

.qrBox img{
width:250px;
margin-top:10px;
}

.payTotal{
font-size:22px;
margin:10px;
color:#e74c3c;
font-weight:bold;
}

.role{
margin-right:10px;
font-weight:bold;
}

.hidden{
display:none;
}

</style>

</head>
<body>

<!-- LOGIN -->
<div id="loginPage">
<div class="login-box">

<h2>üîê Login POS</h2>

<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">

<button onclick="login()">Login</button>

</div>
</div>


<!-- POS -->
<div id="posPage" class="hidden">

<div class="header">
<div>üõí MP SHOP POS PRO MAX</div>

<div>
<span id="roleText"></span>
<button onclick="logout()">Logout</button>
</div>

</div>


<div class="container">

<!-- PRODUCTS -->
<div class="card">

<h3>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>

<input oninput="search(this.value)" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">

<div id="productList"></div>

</div>


<!-- CART -->
<div class="card">

<h3>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h3>

<div id="cart"></div>

<h3 id="totalText">‡∏£‡∏ß‡∏°: 0 ‡∏ö‡∏≤‡∏ó</h3>

<button onclick="showQR()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>

<button class="clearBtn" onclick="clearCart()">üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

</div>


<!-- ADMIN -->
<div id="adminPanel" class="card hidden">

<h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Admin)</h3>

<input id="pname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
<input id="pprice" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">

<button onclick="addProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>

<hr>

<h3>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>

<div id="report"></div>

<button onclick="exportExcel()">Export Excel</button>

</div>


</div>


<!-- QR -->
<div id="qrCard" class="card hidden">

<div class="qrBox">

<h3>üì± ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>

<img src="./promptpay.jpg">

<div id="qrTotal" class="payTotal"></div>

<button onclick="confirmPayment()">‚úî ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</button>

<button onclick="cancelPayment()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>

</div>

</div>


</div>



<script>

/* LOGIN */

const ADMIN_USER="admin";
const ADMIN_PASS="****";

const CASHIER_USER="cashier";
const CASHIER_PASS="****";


/* DATABASE */

let products=
JSON.parse(localStorage.getItem("products")) ||
[
{name:"‡πÇ‡∏Ñ‡πâ‡∏Å",price:15},
{name:"‡∏ô‡πâ‡∏≥",price:10}
];

let cartData=[];

let sales=
JSON.parse(localStorage.getItem("sales"))||[];

let role="";


/* LOGIN */

function login(){

let u=document.getElementById("user").value;
let p=document.getElementById("pass").value;

if(u===ADMIN_USER && p===ADMIN_PASS){

role="admin";

adminPanel.classList.remove("hidden");

}

else if(u===CASHIER_USER && p===CASHIER_PASS){

role="cashier";

}

else{

alert("‚ùå Login ‡∏ú‡∏¥‡∏î");

return;

}

loginPage.classList.add("hidden");

posPage.classList.remove("hidden");

roleText.innerText="üë§ "+role;

renderProducts();

renderCart();

renderReport();

}


/* LOGOUT */

function logout(){

location.reload();

}


/* PRODUCTS */

function renderProducts(){

let box=document.getElementById("productList");

box.innerHTML="";

products.forEach((p,i)=>{

let div=document.createElement("div");

div.className="product";

div.innerText=p.name+" - "+p.price+" ‡∏ö‡∏≤‡∏ó";

div.onclick=()=>addCart(i);

box.appendChild(div);

});

}


function search(text){

let box=document.getElementById("productList");

box.innerHTML="";

products
.filter(p=>p.name.includes(text))
.forEach((p,i)=>{

let div=document.createElement("div");

div.className="product";

div.innerText=p.name+" - "+p.price+" ‡∏ö‡∏≤‡∏ó";

div.onclick=()=>addCart(i);

box.appendChild(div);

});

}


/* CART */

function addCart(index){

cartData.push(products[index]);

renderCart();

}


function renderCart(){

let cart=document.getElementById("cart");

cart.innerHTML="";

let total=0;

cartData.forEach((p,index)=>{

total+=p.price;

let row=document.createElement("div");

row.className="cartItem";

row.innerHTML=
`
<span>${p.name} ${p.price} ‡∏ö‡∏≤‡∏ó</span>
<button class="deleteBtn" onclick="removeItem(${index})">‡∏•‡∏ö</button>
`;

cart.appendChild(row);

});

document.getElementById("totalText").innerText=
"‡∏£‡∏ß‡∏°: "+total+" ‡∏ö‡∏≤‡∏ó";

}


/* REMOVE */

function removeItem(index){

cartData.splice(index,1);

renderCart();

}


/* CLEAR */

function clearCart(){

cartData=[];

renderCart();

}


/* PAYMENT */

function showQR(){

let total=cartData.reduce((sum,p)=>sum+p.price,0);

if(total===0){

alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤");

return;

}

qrCard.classList.remove("hidden");

qrTotal.innerText="‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞: "+total+" ‡∏ö‡∏≤‡∏ó";

}


function confirmPayment(){

let total=cartData.reduce((sum,p)=>sum+p.price,0);

sales.push(total);

localStorage.setItem("sales",JSON.stringify(sales));

cartData=[];

renderCart();

qrCard.classList.add("hidden");

alert("‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

renderReport();

}


function cancelPayment(){

qrCard.classList.add("hidden");

}


/* ADMIN */

function addProduct(){

let name=pname.value;

let price=parseFloat(pprice.value);

if(!name || !price){

alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

return;

}

products.push({name,price});

localStorage.setItem("products",JSON.stringify(products));

renderProducts();

alert("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß");

}


/* REPORT */

function renderReport(){

let total=sales.reduce((sum,p)=>sum+p,0);

report.innerText="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°: "+total+" ‡∏ö‡∏≤‡∏ó";

}


/* EXPORT */

function exportExcel(){

let csv="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢\n";

sales.forEach(s=>csv+=s+"\n");

let blob=new Blob([csv]);

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);

a.download="report.csv";

a.click();

}

</script>
<script>

/* =========================
   MP SHOP POS PRO EXTENSION
   (ADD ONLY - NO MODIFY)
========================= */


/* STOCK DATABASE */

let stockDB =
JSON.parse(localStorage.getItem("stockDB")) || {};


/* INIT STOCK */

function initStock(){

products.forEach(p=>{

if(!stockDB[p.name]){

stockDB[p.name]=100;

}

});

saveStock();

}

function saveStock(){

localStorage.setItem("stockDB",JSON.stringify(stockDB));

}


/* SHOW STOCK */

function renderStock(){

let list=document.getElementById("productList");

let items=list.getElementsByClassName("product");

for(let i=0;i<items.length;i++){

let name=products[i].name;

let qty=stockDB[name] ?? 0;

items[i].innerText=
products[i].name+
" - "+
products[i].price+
" ‡∏ö‡∏≤‡∏ó"+
" (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ "+qty+")";

}

}


/* REDUCE STOCK WHEN ADD CART */

let oldAddCart=addCart;

addCart=function(index){

let name=products[index].name;

if((stockDB[name] ?? 0)<=0){

alert("‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î");

return;

}

oldAddCart(index);

};


/* REDUCE STOCK WHEN CONFIRM PAYMENT */

let oldConfirm=confirmPayment;

confirmPayment=function(){

cartData.forEach(p=>{

stockDB[p.name]--;

});

saveStock();

oldConfirm();

renderStock();

};


/* SALES HISTORY */

function renderHistory(){

let admin=document.getElementById("adminPanel");

let box=document.createElement("div");

box.className="card";

box.innerHTML="<h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>";

sales.slice().reverse().forEach((s,i)=>{

let div=document.createElement("div");

div.innerText=
"‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ "+(sales.length-i)+
" : "+s+" ‡∏ö‡∏≤‡∏ó";

box.appendChild(div);

});

admin.appendChild(box);

}


/* RECEIPT */

function printReceipt(){

let text="MP SHOP RECEIPT\n\n";

cartData.forEach(p=>{

text+=p.name+" "+p.price+" ‡∏ö‡∏≤‡∏ó\n";

});

let total=cartData.reduce((a,b)=>a+b.price,0);

text+="\n‡∏£‡∏ß‡∏° "+total+" ‡∏ö‡∏≤‡∏ó";

let win=window.open();

win.document.write("<pre>"+text+"</pre>");

win.print();

}


/* DASHBOARD */

function renderDashboard(){

let admin=document.getElementById("adminPanel");

let box=document.createElement("div");

box.className="card";

let today=new Date().toDateString();

let total=sales.reduce((a,b)=>a+b,0);

box.innerHTML=
"<h3>Dashboard</h3>"+
"‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: "+total+" ‡∏ö‡∏≤‡∏ó<br>"+
"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•: "+sales.length;

admin.appendChild(box);

}


/* BACKUP */

function backupData(){

let data={

products,
sales,
stockDB

};

let blob=new Blob([JSON.stringify(data)]);

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);

a.download="backup.json";

a.click();

}


/* RESTORE */

function restoreData(){

let input=document.createElement("input");

input.type="file";

input.onchange=function(e){

let file=e.target.files[0];

let reader=new FileReader();

reader.onload=function(){

let data=JSON.parse(reader.result);

localStorage.setItem("products",JSON.stringify(data.products));
localStorage.setItem("sales",JSON.stringify(data.sales));
localStorage.setItem("stockDB",JSON.stringify(data.stockDB));

alert("Restore ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤");

};

reader.readAsText(file);

};

input.click();

}


/* ADD ADMIN BUTTONS */

function addAdminButtons(){

let admin=document.getElementById("adminPanel");

let backupBtn=document.createElement("button");

backupBtn.innerText="Backup";

backupBtn.onclick=backupData;

admin.appendChild(backupBtn);

let restoreBtn=document.createElement("button");

restoreBtn.innerText="Restore";

restoreBtn.onclick=restoreData;

admin.appendChild(restoreBtn);

}


/* INIT EXTENSION */

let oldLogin=login;

login=function(){

oldLogin();

initStock();

renderStock();

renderHistory();

renderDashboard();

addAdminButtons();

};


</script>

</body>
</html>
