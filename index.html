<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>MP SHOP POS PRO MAX</title>

<style>

body{
font-family:Arial;
background:#f0f2f5;
margin:0;
}

.header{
background:#2c3e50;
color:white;
padding:15px;
display:flex;
justify-content:space-between;
}

.container{
padding:20px;
}

.card{
background:white;
padding:15px;
margin-bottom:15px;
border-radius:8px;
box-shadow:0 0 5px rgba(0,0,0,0.2);
}

button{
background:#3498db;
color:white;
border:none;
padding:10px;
width:100%;
margin-top:5px;
cursor:pointer;
}

button:hover{
background:#2980b9;
}

input{
width:100%;
padding:8px;
margin-top:5px;
}

.hidden{
display:none;
}

.login-box{
width:300px;
margin:100px auto;
background:white;
padding:20px;
border-radius:10px;
box-shadow:0 0 10px rgba(0,0,0,0.3);
}

.product{
padding:10px;
background:#ecf0f1;
margin:5px;
cursor:pointer;
}

.product:hover{
background:#d0d7de;
}

.qrBox{
text-align:center;
}

.qrBox img{
width:250px;
margin-top:10px;
}

.payTotal{
font-size:20px;
margin:10px;
color:#e74c3c;
font-weight:bold;
}

</style>

</head>
<body>

<!-- LOGIN -->
<div id="loginPage">

<div class="login-box">

<h2>üîê Login POS</h2>

<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">

<button onclick="login()">Login</button>

</div>

</div>

<!-- POS PAGE -->
<div id="posPage" class="hidden">

<div class="header">

<div>üõí MP SHOP POS PRO MAX</div>

<div>
<span id="roleText"></span>
<button onclick="logout()">Logout</button>
</div>

</div>

<div class="container">

<div class="card">

<h3>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>

<input oninput="search(this.value)" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">

<div id="productList"></div>

</div>

<div class="card">

<h3>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h3>

<div id="cart"></div>

<div id="total">‡∏£‡∏ß‡∏°: 0 ‡∏ö‡∏≤‡∏ó</div>

<button onclick="showQR()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>

</div>

<!-- QR PAYMENT -->
<div id="qrCard" class="card hidden">

<div class="qrBox">

<h3>üì± ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>

<!-- FIX PATH -->
<img src="./promptpay.jpg" id="qrImage">

<div class="payTotal" id="qrTotal"></div>

<button onclick="confirmPayment()">‚úî ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</button>

<button onclick="cancelPayment()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>

</div>

</div>

<!-- ADMIN -->
<div id="adminPanel" class="hidden">

<div class="card">

<h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Admin)</h3>

<input id="pname" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
<input id="pprice" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">

<button onclick="addProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>

</div>

<div class="card">

<h3>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h3>

<div id="report"></div>

<button onclick="exportExcel()">Export Excel</button>

</div>

</div>

</div>

</div>

<script>

// DATABASE
let products =
JSON.parse(localStorage.getItem("products")) ||
[
{name:"‡πÇ‡∏Ñ‡πâ‡∏Å",price:15},
{name:"‡∏ô‡πâ‡∏≥",price:10}
];

let cartData=[];

let sales =
JSON.parse(localStorage.getItem("sales"))||[];

let role="";


// LOGIN
function login(){

let u=document.getElementById("user").value;
let p=document.getElementById("pass").value;

if(u=="admin" && p=="1234"){
role="admin";
}
else if(u=="cashier" && p=="0000"){
role="cashier";
}
else{
alert("Login ‡∏ú‡∏¥‡∏î");
return;
}

document.getElementById("loginPage").classList.add("hidden");
document.getElementById("posPage").classList.remove("hidden");

document.getElementById("roleText").innerText=role;

if(role=="admin"){
document.getElementById("adminPanel").classList.remove("hidden");
}

renderProducts();
renderCart();
renderReport();

}


// LOGOUT
function logout(){
location.reload();
}


// PRODUCTS
function renderProducts(){

let productList=document.getElementById("productList");

productList.innerHTML="";

products.forEach(p=>{

let div=document.createElement("div");

div.className="product";

div.innerText=p.name+" - "+p.price+" ‡∏ö‡∏≤‡∏ó";

div.onclick=()=>addCart(p);

productList.appendChild(div);

});

}


// SEARCH
function search(text){

let filtered=products.filter(p=>p.name.includes(text));

let productList=document.getElementById("productList");

productList.innerHTML="";

filtered.forEach(p=>{

let div=document.createElement("div");

div.className="product";

div.innerText=p.name+" - "+p.price+" ‡∏ö‡∏≤‡∏ó";

div.onclick=()=>addCart(p);

productList.appendChild(div);

});

}


// ADD CART
function addCart(p){

cartData.push(p);

renderCart();

}


// RENDER CART
function renderCart(){

let cart=document.getElementById("cart");

cart.innerHTML="";

let total=0;

cartData.forEach(p=>{

total+=p.price;

let div=document.createElement("div");

div.innerText=p.name+" "+p.price+" ‡∏ö‡∏≤‡∏ó";

cart.appendChild(div);

});

document.getElementById("total").innerText=
"‡∏£‡∏ß‡∏°: "+total+" ‡∏ö‡∏≤‡∏ó";

}


// SHOW QR
function showQR(){

let total=
cartData.reduce((a,b)=>a+b.price,0);

if(total==0){
alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤");
return;
}

document.getElementById("qrCard")
.classList.remove("hidden");

document.getElementById("qrTotal")
.innerText="‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞: "+total+" ‡∏ö‡∏≤‡∏ó";

}


// CONFIRM PAYMENT
function confirmPayment(){

let total=
cartData.reduce((a,b)=>a+b.price,0);

sales.push(total);

localStorage.setItem(
"sales",
JSON.stringify(sales)
);

cartData=[];

renderCart();

document.getElementById("qrCard")
.classList.add("hidden");

alert("‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

renderReport();

}


// CANCEL
function cancelPayment(){

document.getElementById("qrCard")
.classList.add("hidden");

}


// ADMIN
function addProduct(){

let name=document.getElementById("pname").value;
let price=parseFloat(
document.getElementById("pprice").value
);

products.push({name,price});

localStorage.setItem(
"products",
JSON.stringify(products)
);

renderProducts();

}


// REPORT
function renderReport(){

let total=
sales.reduce((a,b)=>a+b,0);

document.getElementById("report")
.innerText="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏°: "+total+" ‡∏ö‡∏≤‡∏ó";

}


// EXPORT
function exportExcel(){

let csv="‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢\n";

sales.forEach(s=>{
csv+=s+"\n";
});

let blob=new Blob([csv]);

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);

a.download="report.csv";

a.click();

}

</script>

</body>
</html>
